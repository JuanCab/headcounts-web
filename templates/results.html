{% extends "base.html" %}
{% block title %} Results {% endblock %}


{% block content %}
<div class="container no-results-container">
    {% if n_rows == 0 %}
        <div class="alert alert-warning mt-4 text-center">
            <i class="fas fa-search-minus fa-2x mb-3 text-warning"></i>
            <h2>No Courses Found</h2>
            <p class="text-muted mb-2">{{ subject|replace('\n', '<br>')|safe }}</p>
            <p class="lead">No courses matched your search. Please adjust your filters and try again.</p>
        </div>
    {% else %}
        <div class="container results-container">
            <div class="results-header mb-4 mt-4 p-3">
                <h2 class="mb-2">Course Data</h2>
                <div class="results-subtext text-muted">
                    {{ subject|replace('\n', '<br>')|safe }}
                </div>
            </div>
            <table class="table table-striped table-bordered" style="width: 80%;">
                <tbody>
                    <tr><td style="text-align: right; width: 60%;">Credit hours generated by these {{ n_rows }} courses (assume variable credit is 1 credit):</td><td style="width: 20%">{{ sch }}</td></tr>
                    <tr><td style="text-align: right; width: 60%;">Calculated tuition revenue (assuming all in-state):</td><td style="width: 20%">{{ revenue }}</td></tr>
                    <tr><td style="text-align: right; width: 60%;">Total empty seats in these courses (excludes canceled):<br/>(<b>Note</b>: the number of empty seats is the course size limit (Size) minus the enrollment or zero if the course is over-enrolled.)</td>
                        <td style="width: 20%">{{ seats['empty'] }} of {{ seats['available'] }} available<br/>({{ (100 * seats['empty'] / seats['available']) | round(2) }}% empty)</td></tr>
                    <tr><td colspan=2>The data in this table was retrieved from the online course catalog between {{ oldest }} and {{ most_recent }}.</td></tr>
                </tbody>
            </table>
            
            <h4>The table shown below {% if n_rows < max_rows %} contains {{ n_rows }}{% else %} 
                only contains the first {{ max_rows }} of {{ n_rows }} {% endif %} rows of data. 
                The full dataset is available as a <a href="{{ url_for('download', filename=csv_file) }}">CSV file</a> 
                or <a href="{{ url_for('download', filename=excel_file) }}">Excel file</a>.</h4>

            {{ rendered_table | safe }}


        </div>
    {% endif %}
</div>

{% endblock %}